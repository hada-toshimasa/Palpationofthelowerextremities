<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>触診マニュアル（腰部・下肢）完全攻略マスター</title>
<style>
    body { font-family: "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f0f8ff; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: relative; }
    h1 { text-align: center; color: #0056b3; margin-bottom: 25px; font-size: 1.8em; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .reset-btn { position: absolute; top: 20px; right: 20px; background: #95a5a6; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    .reset-btn:hover { background: #7f8c8d; }
    .status-bar { background: #e3f2fd; padding: 12px 20px; border-radius: 8px; display: flex; justify-content: space-between; color: #0277bd; font-weight: bold; margin-bottom: 25px; }
    .question-box { background: #f9f9f9; border-left: 6px solid #0056b3; padding: 20px; margin-bottom: 25px; font-size: 1.15em; font-weight: bold; line-height: 1.5; }
    .option-btn { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1em; color: #444; }
    .option-btn:hover { background-color: #f0f8ff; border-color: #0056b3; }
    .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
    .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .feedback { display: none; margin-top: 20px; padding: 20px; border-radius: 8px; background: #f1f8e9; border: 1px solid #c8e6c9; color: #2e7d32; animation: fadeIn 0.3s; }
    .feedback.error { background: #fdecea; border: 1px solid #fadbd8; color: #7b241c; }
    .source-ref { display: block; margin-top: 8px; font-size: 0.85em; color: #666; text-align: right; font-style: italic; }
    .next-btn { display: block; width: 100%; padding: 18px; background: #0056b3; color: #fff; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 25px; opacity: 0.6; pointer-events: none; transition: 0.3s; }
    .next-btn.active { opacity: 1; pointer-events: auto; }
    .next-btn:hover { background-color: #004494; }
    #result-screen { display: none; text-align: center; padding: 20px; }
    .score-circle { width: 150px; height: 150px; background: #0056b3; color: #fff; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    .score-num { font-size: 3.5em; font-weight: bold; line-height: 1; }
    .score-label { font-size: 0.9em; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="container">
    <div id="start-screen" style="text-align: center; padding: 40px 0;">
        <h1 style="border: none;">触診マニュアル（腰部・下肢）<br>完全攻略マスター</h1>
        <p style="font-size: 1.1em; margin-bottom: 30px;">全250問のプールから<br>ランダムに30問出題されます。</p>
        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 40px;">合格ライン: 80%以上</p>
        <button class="next-btn active" onclick="startQuiz()">試験を開始する</button>
    </div>

    <div id="quiz-screen" style="display: none;">
        <button class="reset-btn" onclick="resetQuiz()">最初に戻る</button>
        <h1>触診クイズ</h1>
        <div class="status-bar">
            <span id="progress">問 1 / 30</span>
            <span id="score">正解数: 0</span>
        </div>
        <div id="question" class="question-box"></div>
        <div id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="next-btn" onclick="nextQuestion()">次の問題へ</button>
    </div>

    <div id="result-screen">
        <h2>試験終了</h2>
        <div class="score-circle">
            <span class="score-num" id="final-score">0</span>
            <span class="score-label">点 / 30点</span>
        </div>
        <p id="result-comment" style="font-size: 1.2em; margin: 20px 0;"></p>
        <button class="next-btn active" onclick="resetQuiz(true)">もう一度挑戦する</button>
    </div>
</div>

<script>
// --- 問題プール パート1 (腰部・骨盤・大腿・膝・下腿) ---
const poolPart1 = [
    // 腰部（骨）
    {q:"腰椎を屈曲すると棘突起間はどうなるか？",o:["開く","狭くなる","変化しない","回旋する"],c:0,r:"棘突起の特徴として、腰椎を屈曲すると棘突起間が開き、伸展すると狭くなります。",s:"3ページ"},
    {q:"立位で腰椎棘突起を触診する際、背部の筋を緩めるためにとるべき肢位は？",o:["最大屈曲位","少しだけ伸展させる","側屈位","回旋位"],c:1,r:"立位で屈曲すると背部の筋が遠心性に収縮して緊張するため、少しだけ伸展させ筋を緩めた状態で触診します。",s:"3ページ"},
    {q:"ヤコビー線（腸骨稜の最高点）の高さに一致する腰椎棘突起は？",o:["第2腰椎","第3腰椎","第4腰椎（またはL4/L5間）","第5腰椎"],c:2,r:"ヤコビー線は第4腰椎棘突起、または第4-5腰椎棘突起間の高さに一致します。",s:"4ページ"},
    {q:"臨床において、第5腰椎棘突起はベルトラインに対してどの位置にあると考えるべきか？",o:["必ず上","同じ高さ","必ず下","個人差が大きい"],c:2,r:"第5腰椎棘突起は必ずベルトライン（ヤコビー線）より下にあります。",s:"4ページ"},
    {q:"第4腰椎棘突起の下方に触れる棘突起は？",o:["第3腰椎","第5腰椎","仙骨稜","胸椎"],c:1,r:"第4腰椎の下方にあるのが第5腰椎棘突起です。",s:"5ページ"},

    // 腰部（筋）
    {q:"腰部の筋で、上位腰部では厚く、下位腰部に向かうにつれて薄くなる（腱組織になる）筋は？",o:["多裂筋","最長筋","腰方形筋","大殿筋"],c:1,r:"最長筋は上位腰部では厚いですが、下位腰部に向かうに従い厚みが減り、腱組織になることもあります。",s:"8ページ"},
    {q:"下位腰部に向かうほど厚みを増す腰部の筋は？",o:["最長筋","腸肋筋","多裂筋","広背筋"],c:2,r:"多裂筋は下位腰部に向かうほど厚みを増していきます。",s:"8ページ"},
    {q:"腰部多裂筋の触診で、上体を前傾させるとどうなるか？",o:["弛緩する","緊張する","変化しない","見えなくなる"],c:1,r:"上体を前傾させると緊張し、後傾させると弛緩します。",s:"8ページ"},
    {q:"最長筋・腸肋筋の触診で、足を浮かせた側（遊脚側）はどうなるか？",o:["弛緩する","収縮する","痙攣する","変化しない"],c:1,r:"足踏みをしたとき、足を浮かせた側（遊脚側）で収縮します。",s:"9ページ"},
    {q:"腰方形筋の主な作用は？",o:["腰椎の強力な伸展","骨盤挙上・体幹の同側側屈","股関節屈曲","体幹回旋"],c:1,r:"腰背部の筋でありながら腰椎伸展作用はそれほどなく、主に骨盤挙上や同側側屈に作用します。",s:"10ページ"},
    {q:"腰方形筋の触診で、第12肋骨のどの部分からたどるか？",o:["肋骨角","先端の下縁","椎体との関節部","上面"],c:1,r:"第12肋骨の先端からその下縁を内側にたどり、筋の壁に突き当たるところを触診します。",s:"10ページ"},

    // 骨盤（骨）
    {q:"腸骨稜の最前部にあり、円を描くように触れたとき最も突出した部分は？",o:["下前腸骨棘","上前腸骨棘（ASIS）","大転子","恥骨結節"],c:1,r:"腸骨稜の最前部で最も突出した部分が上前腸骨棘（ASIS）です。",s:"14ページ"},
    {q:"骨盤の前後傾斜の評価で、ASISに対してPSISは通常どの位置にあるか？",o:["同じ高さ","2-3横指下方","2-3横指上方","5横指上方"],c:2,r:"通常、PSIS（上後腸骨棘）はASIS（上前腸骨棘）に対して2-3横指上方に位置します。",s:"13ページ"},
    {q:"骨盤が「後傾」していると判断されるのは、ASISとPSISの高さの差がどういう場合か？",o:["差が小さい（水平に近い）","差が大きい（PSISがかなり高い）","差がない","PSISが下にある"],c:0,r:"高さの差が小さい（2-3横指未満）場合は後傾、大きい場合は前傾と判断します。",s:"13ページ"},
    {q:"下前腸骨棘（AIIS）はASISのどの位置にあるか？",o:["外側上方","内側下方約2横指","真下","真後ろ"],c:1,r:"ASISの内側下方約2横指の位置に触れる骨の膨らみが下前腸骨棘です。",s:"15ページ"},
    {q:"恥骨結合は両ASISを結んだ線よりどの程度下方に位置するか？",o:["1横指","2横指","4-5横指","10横指"],c:2,r:"恥骨結合は両ASISを結んだ線より約4-5横指下方に位置しています。",s:"16ページ"},
    {q:"恥骨結節を確認するために、恥骨結合からどちらへたどるか？",o:["内側へ1-2横指","外側へ1-2横指","上方へ1-2横指","下方へ1-2横指"],c:1,r:"恥骨結合から外側へ1-2横指たどると、恥骨が急に後方へと角度を変える部位が恥骨結節です。",s:"17ページ"},
    {q:"坐骨結節の触診において、触れやすい面は？",o:["内側面","足底面","外側面と後面","上面"],c:2,r:"坐骨結節の外側面と後面は触れやすいですが、足底面・内側面は足底腱膜などで触れにくいです。",s:"25ページ"},
    {q:"上後腸骨棘（PSIS）はASISより約何横指高い位置にあるか？",o:["同じ","1横指","2横指","5横指"],c:2,r:"通常、PSISはASISより2横指ほど高い位置にあります。",s:"24ページ"},

    // 殿部（筋・神経）
    {q:"大殿筋の触診で、収縮を確認するために行う動作は？",o:["股関節屈曲・内旋","股関節伸展・外旋","膝伸展","足関節背屈"],c:1,r:"股関節を軽度伸展してつま先を浮かせ、膝を外側に捻る（股関節外旋）と収縮を確認できます。",s:"27ページ"},
    {q:"中殿筋の触診で、深部にある小殿筋を緩めて中殿筋だけを触れやすくする肢位は？",o:["足先を内側に向ける","足先を外側に向ける（股関節外旋）","足をクロスする","膝を曲げる"],c:1,r:"足先を外に向けて行う（股関節外旋を伴わせる）と小殿筋を抑制でき、中殿筋を触知しやすくなります。",s:"27ページ"},
    {q:"梨状筋の触診位置は、大転子先端部のどこか？",o:["直上","2横指前方","2横指後方","2横指下方"],c:2,r:"大転子先端部の2横指後方を、3本の指を並べて広く触れます。",s:"28ページ"},
    {q:"大腿方形筋の触診位置は、大転子のどこか？",o:["2横指上方","2横指下方","2横指前方","先端"],c:1,r:"大転子の2横指下の後方（坐骨の外側面）で触診します。",s:"29ページ"},
    {q:"仙結節靭帯を触診する際、指を動かす方向は？",o:["靭帯と平行に","靭帯と直交する方向に","円を描くように","圧迫のみ"],c:1,r:"坐骨結節と仙骨を結ぶ線に直交する方向に指を動かすと、太い線維に触れます。",s:"29ページ"},
    {q:"坐骨神経の触診位置は、坐骨結節頂点からどの程度外側か？",o:["直上","1横指","2横指程度","5横指"],c:2,r:"坐骨の骨面が斜めになって深部に向かうあたり（頂点から2横指程度）で触れます。",s:"30ページ"},
    {q:"上殿皮神経の圧痛点は、腸骨稜のどのあたりにあるか？",o:["最前部（ASIS付近）","最後部（PSIS付近）","外側で斜めの走行が水平化する部位","仙骨上"],c:2,r:"腸骨稜を外側へ触れ、斜めに上行する腸骨稜が水平化する部位のすぐ外側で圧痛を生じます。",s:"30ページ"},

    // 転子部・大腿（骨・筋・神経）
    {q:"大転子の上端を結ぶ線（ロズ・ネラトン線）は、何の中心を通るか？",o:["膝蓋骨","大腿骨頭","坐骨結節","L4棘突起"],c:1,r:"両側の大転子上端を結ぶ線は大腿骨頭の中心を通過します。",s:"32ページ"},
    {q:"大転子が最も外に突き出た部位は、骨盤のどの高さと同じか？",o:["ASIS","PSIS","恥骨結合","腸骨稜最高点"],c:2,r:"大転子が最も外に突き出た部位は恥骨結合と同じ高さにあります。",s:"32ページ"},
    {q:"転子間稜を触診する際、下肢をどう動かすと確認しやすいか？",o:["内旋時","外旋時","屈曲時","伸展時"],c:0,r:"膝を内側に動かしたとき（内旋時）に、急に触れた部分が低くなる角が転子間稜です。",s:"34ページ"},
    {q:"スカルパ三角を構成する3辺に含まれないのは？",o:["鼠径靭帯","縫工筋","長内転筋","大腿筋膜張筋"],c:3,r:"スカルパ三角は鼠径靭帯、縫工筋、長内転筋の上縁で囲まれた領域です。",s:"18ページ"},
    {q:"スカルパ三角内で触診できる神経は？",o:["坐骨神経","大腿神経","閉鎖神経","脛骨神経"],c:1,r:"スカルパ三角内（大腿動脈の外側）で大腿神経を触診できます。",s:"18ページ"},
    {q:"大腿筋膜張筋の触診で、膨隆を確認するための股関節運動は？",o:["外旋","内旋","伸展","内転"],c:1,r:"上前腸骨棘のすぐ外側を触れながら、股関節を内旋させると膨隆します。",s:"21ページ"},
    {q:"大腿外側皮神経の触診部位は？",o:["ASISの内側","ASISの直下","鼠径靭帯の最外側部（縫工筋起始部の内下方）","大転子の上"],c:2,r:"縫工筋起始部の内下方（鼠径靭帯の最外側部）を圧迫して確認します。",s:"21ページ"},
    {q:"大腿直筋の触診で、膝に上方から抵抗をかけたとき、どこに膨隆するか？",o:["大腿遠位内側","大腿近位前面","大腿外側","膝蓋骨上"],c:1,r:"股関節を屈曲し膝に抵抗をかけたとき、大腿近位前面に長軸方向に膨隆します。",s:"36ページ"},
    {q:"外側広筋の触診で、後縁をたどるとどの筋との境界に触れるか？",o:["大腿直筋","内側広筋","大腿二頭筋長頭","半膜様筋"],c:2,r:"外側広筋の後縁を近位へたどると、大腿二頭筋長頭との境を触れます。",s:"36ページ"},
    {q:"内側広筋の触診で、膝を強く伸展するとどこに膨隆するか？",o:["大腿近位内側","大腿遠位内側","大腿中央","膝蓋骨の上"],c:1,r:"膝関節を強く伸展すると、大腿遠位内側部に大きく膨隆します。",s:"37ページ"},
    {q:"縫工筋の起始部はどこか？",o:["下前腸骨棘","上前腸骨棘（ASIS）","恥骨結節","坐骨結節"],c:1,r:"上前腸骨棘から起始し、大腿内側面を斜めに走行します。",s:"37ページ"},
    {q:"内側ハムストリングスを構成する筋は？",o:["大腿二頭筋と半腱様筋","半腱様筋と半膜様筋","大腿二頭筋と半膜様筋","薄筋と縫工筋"],c:1,r:"内側ハムストリングスは半腱様筋と半膜様筋です。",s:"38ページ"},
    {q:"半腱様筋を触診する際、足先をどうして膝を屈曲させるか？",o:["外側に向ける","内側に向ける","背屈する","底屈する"],c:1,r:"足先を内側に向けて（下腿内旋位で）膝の等尺性屈曲を行うと腱が浮き出ます。",s:"39ページ"},
    {q:"半膜様筋の筋腹は、半腱様筋腱のどの位置で触れるか？",o:["表層","奥（深層）","外側","遠位"],c:1,r:"半腱様筋の腱の奥（大腿遠位後面内側）で、幅広い筋腹として触れます。",s:"39ページ"},
    {q:"大腿二頭筋長頭腱が浮き出る動作は？",o:["膝を伸ばす","椅坐位から殿部を浮かせる（立ち上がる）","足を組む","膝を内側に倒す"],c:1,r:"椅坐位から頭を下げて立ち上がるように殿部を浮かせると、膝外側後方に太い腱が浮き出ます。",s:"40ページ"},
    {q:"大腿二頭筋短頭はどこで触れるか？",o:["外側広筋後縁と大腿二頭筋腱の間","大腿二頭筋腱の後ろ","膝窩の中央","半腱様筋の内側"],c:0,r:"外側広筋後縁と大腿二頭筋腱との間で触れる柔軟な部分です。",s:"40ページ"},
    {q:"長内転筋の触診で、股関節をどう動かすと緊張するか？",o:["伸展・外転","屈曲・内転","伸展・内転","反対側の膝を曲げて腰を下ろす（伸展・外転位）"],c:3,r:"立位で開脚し、反対側の膝を曲げて腰を下ろしていく（伸張させる）と緊張を確認しやすいです。",s:"42ページ"},
    {q:"薄筋を触診する際、骨盤をどう回旋させると触れやすいか？",o:["同側に回旋","反対側に回旋","回旋しない","後傾させる"],c:1,r:"椅坐位で脚を伸ばして開き、骨盤を反対側に捻った状態で大腿内側を撫で上げると触れやすいです。",s:"42ページ"},
    {q:"伏在神経を触診する際のランドマークとなる筋は？",o:["大腿直筋","外側広筋","内側広筋（の最後部）と大内転筋の間","半膜様筋"],c:2,r:"大腿骨内側顆の近位、内側広筋の最後部（内側縁）を圧迫して確認します。",s:"43ページ"},

    // 膝関節（骨・靭帯・軟部組織）
    {q:"膝蓋骨は、大腿四頭筋内に存在する人体最大の何か？",o:["扁平骨","種子骨","長管骨","不整骨"],c:1,r:"膝蓋骨は人体最大の種子骨です。",s:"45ページ"},
    {q:"膝蓋骨の下縁（尖った部分）を確認するには、膝蓋骨をどう押すか？",o:["上縁を下方に押す","下縁を上方に押す","内側を押す","外側を押す"],c:0,r:"上縁を下方に押すと、下縁（膝蓋骨尖）が浮き上がり確認しやすくなります。",s:"46ページ"},
    {q:"大腿骨膝蓋面（滑車）を触診するのに適した膝の肢位は？",o:["完全伸展位","90度屈曲位","深屈曲（全屈曲）位","過伸展位"],c:2,r:"膝を深く曲げると膝蓋骨が遠位に移動し、膝蓋骨の手前（近位）で膝蓋面が露出します。",s:"46ページ"},
    {q:"脛骨粗面の位置は、膝蓋骨からどの程度遠位か？",o:["1横指","3横指","5横指","10横指"],c:1,r:"膝蓋骨から約3横指遠位にある骨の膨らみです。",s:"47ページ"},
    {q:"大腿骨外側上顆は、大腿骨外側顆のどのあたりにあるか？",o:["最前方","中央やや後方","最後方","最遠位"],c:1,r:"大腿骨外側顆の中央やや後方で、最も膨らんだ部位です。",s:"49ページ"},
    {q:"ガーディー結節の位置は？",o:["脛骨粗面の真下","脛骨粗面のすぐ外側（脛骨前外側部最近位）","腓骨頭の後ろ","膝蓋骨の上"],c:1,r:"脛骨粗面の外側にある斜線を近位へたどり、関節裂隙のすぐ遠位にある膨らみです。",s:"50ページ"},
    {q:"腓骨頭は下腿近位のどの位置にあるか？",o:["最内側","最外側（かつ後方）","最前方","関節内"],c:1,r:"下腿近位部を膝の後方から触れるとき、最後方・最外側で触れる骨隆起です。",s:"51ページ"},
    {q:"内転筋結節の位置は、内側上顆から見てどこか？",o:["1横指近位、1横指後方","1横指遠位、1横指前方","真下","真上"],c:0,r:"内側上顆から1横指近位、1横指後方に位置し、大内転筋腱が付着します。",s:"55ページ"},
    {q:"膝蓋下脂肪体はどの靭帯の深層に存在するか？",o:["内側側副靭帯","外側側副靭帯","膝蓋靭帯","前十字靭帯"],c:2,r:"膝蓋骨と脛骨粗面をつなぐ膝蓋靭帯の深層に存在します。",s:"56ページ"},
    {q:"膝蓋下脂肪体の触診で、一方を推すと反対側がどうなるか？",o:["凹む","押し出される（膨らむ）","変わらない","痛む"],c:1,r:"連結しているため、一方を押すと反対側の指に押し出される感覚があります。",s:"57ページ"},
    {q:"大腿四頭筋腱の形状は？",o:["円形","四角形","膝蓋骨底を底辺とする三角形","線状"],c:2,r:"内側広筋と外側広筋の間にあり、膝蓋骨底を底辺とする三角形をしています。",s:"58ページ"},
    {q:"膝蓋靭帯の緊張を確認する動作は？",o:["膝を伸ばして踵を持ち上げる（床を押す）","膝を曲げる","つま先を上げる","膝を内に入れる"],c:0,r:"膝90度屈曲位で、踵で床を押す（膝伸展しようとする）と緊張します。",s:"58ページ"},
    {q:"内側側副靭帯（MCL）の触診位置は？",o:["関節裂隙の前方","関節裂隙の側方で指が入らなくなる部分のさらに2横指後方","膝蓋骨の直上","膝窩の中央"],c:1,r:"関節裂隙を側方へたどり、指が入らなくなる所からさらに2横指後方で再び触れる裂隙の間にあります。",s:"59ページ"},
    {q:"腸脛靭帯を触診する際、膝を伸ばしたまま腰をどうすると触れやすいか？",o:["反対側に引く","同側に突き出す","前屈する","後屈する"],c:1,r:"膝を伸ばしたまま腰を同側に突き出すと、大腿外側で緊張して触れやすくなります。",s:"61ページ"},
    {q:"腸脛靭帯の遠位付着部は？",o:["腓骨頭","脛骨粗面","ガーディー結節","内側顆"],c:2,r:"大腿骨外側上顆を通過し、脛骨のガーディー結節に付着します。",s:"61ページ"},
    {q:"外側側副靭帯（LCL）を触診する際の肢位は？",o:["完全伸展位","あぐらをかくように足を乗せる（股関節屈曲外旋・膝屈曲）","正座","仰向け"],c:1,r:"あぐらをかくように足を乗せると、腓骨頭から大腿骨へ走る索状の靭帯が触れやすくなります。",s:"62ページ"},

    // 下腿（骨・筋・神経）
    {q:"脛骨の断面はどのような形状か？",o:["円形","四角形","三角形","楕円形"],c:2,r:"前縁、骨間縁、内側縁の3つの稜線を持つ三角形をしています。",s:"63ページ"},
    {q:"脛骨内側縁より後方（内側）にある近位の筋肉は？",o:["前脛骨筋","長趾伸筋","腓腹筋・ヒラメ筋","長腓骨筋"],c:2,r:"脛骨内側縁の後方には、近位では腓腹筋とヒラメ筋があります。",s:"64ページ"},
    {q:"「弁慶の泣き所」と呼ばれる骨隆起は？",o:["脛骨前縁","脛骨内側縁","腓骨前縁","腓骨後縁"],c:0,r:"脛骨の前面を縦に延びる鋭い骨隆起が脛骨前縁です。",s:"63ページ"},
    {q:"前脛骨筋を触診する際の足の動きは？",o:["底屈・外反","背屈・内反","底屈・内反","背屈・外反"],c:1,r:"踵をつけて足先を強く持ち上げる（背屈かつ内反）と大きく膨隆します。",s:"66ページ"},
    {q:"長趾伸筋を触診する際の足の動きは？",o:["足趾を床から浮かせる（伸展）","足趾を曲げる","足首を底屈する","踵を上げる"],c:0,r:"足底をつけたまま足趾を浮かせると、腓骨頭の前方で収縮します。",s:"66ページ"},
    {q:"長母趾伸筋腱が触れやすい部位は？",o:["下腿近位","足関節の前方（前脛骨筋腱の外側）","外果の後ろ","踵"],c:1,r:"足関節の前方で、前脛骨筋腱の外側から深層に入った腱を確認できます。",s:"67ページ"},
    {q:"浅腓骨神経を圧迫して放散痛を確認する部位は？",o:["膝窩中央","腓骨頭の前方直下（前脛骨筋と長腓骨筋の境界）","内果の下","アキレス腱の内側"],c:1,r:"腓骨頭の前方直下を圧迫すると、下腿外側から足背へ放散痛が生じます。",s:"67ページ"},
    {q:"腓腹筋を触診する際、足関節をどう動かすと膨隆するか？",o:["背屈","底屈（つま先で床を押す）","内反","外反"],c:1,r:"つま先で床を押すように底屈すると、手掌の中で大きく膨隆します。",s:"69ページ"},
    {q:"ヒラメ筋を触診する際、腓腹筋と区別するための方法は？",o:["膝を伸ばして行う","膝を曲げて行う","足趾を反らす","踵を床につける"],c:1,r:"膝を曲げて（腓腹筋を緩めて）行うか、腓腹筋の深層・遠位（踵から10cm上方など）で触れます。",s:"69ページ"},
    {q:"脛骨神経を触診する際、膝窩のどこを圧迫するか？",o:["中央（腓腹筋内側頭と外側頭の間）","最外側","最内側","膝蓋骨の上"],c:0,r:"膝裏の中央に母指を沈め、脛骨粗面方向へ圧迫すると放散痛を確認できます。",s:"70ページ"},
    {q:"膝窩筋を触診する際、下腿をどう動かすと緊張するか？",o:["外旋","内旋","外反","内反"],c:1,r:"踵を接地したまま足先を内側に向ける（下腿内旋）と、脛骨内側縁の裏側でわずかに緊張します。",s:"70ページ"},
    {q:"長腓骨筋の収縮を確認する足の動きは？",o:["母趾を上げる","小趾側を浮かせる（外がえし）","踵を上げる","つま先を上げる"],c:1,r:"踵と母指球をつけたまま、小趾を浮かせる（外がえし）と腓骨頭直下で収縮します。",s:"72ページ"},
    {q:"短腓骨筋の収縮を確認する足の動きは？",o:["強く背屈する","強く底屈しながら外がえし","内がえし","指を反らす"],c:1,r:"つま先を床につけたまま強く底屈（および外がえし傾向）すると、下腿遠位外側で収縮します。",s:"72ページ"},
    {q:"長腓骨筋腱と短腓骨筋腱の位置関係（外果後方）は？",o:["長腓骨筋が前、短腓骨筋が後","短腓骨筋が前（深部）、長腓骨筋が後（表層）","並列している","交差している"],c:1,r:"短腓骨筋は外果の直後（深部）、長腓骨筋はその表層（後方）を通ります。指を後方にずらすと短腓骨筋の後縁に落ち込みます。",s:"73ページ"},
    {q:"総腓骨神経（腓骨神経）の触診部位は？",o:["腓骨頭の後方やや内側","腓骨頭の真上","脛骨粗面","膝窩中央"],c:0,r:"腓骨頭の後方・やや内側を圧迫し、指をスライドさせると索状の神経と放散痛を確認できます。",s:"73ページ"},
];
    // --- 問題プール パート2 (膝軟部・下腿・足部・システム) ---
const poolPart2 = [
    // 膝関節（軟部組織）
    {q:"膝蓋下脂肪体の触診で、膝蓋靭帯の深層にある脂肪体を確認するために行う操作は？",o:["一方を押し込み、反対側の膨らみを感じる","膝を深く曲げる","膝蓋骨を上に引き上げる","強く叩く"],c:0,r:"膝蓋靭帯の両側を触れ、一方を押し込むと反対側に脂肪体が押し出されるのを確認します。",s:"57ページ"},
    {q:"大腿四頭筋腱を触診する際、内側広筋と外側広筋の境界はどのような形になるか？",o:["逆ハの字（三角形）","平行","円形","一直線"],c:0,r:"膝蓋骨底を底辺とし、近位に向かって先細る「ハの字」あるいは三角形の形状をしています。",s:"58ページ"},
    {q:"膝蓋靭帯の幅と緊張を確認するのに適した動作は？",o:["膝伸展（踵で床を押す）","膝屈曲","股関節外旋","足関節背屈"],c:0,r:"膝を90度屈曲した状態で、踵で床を押す（等尺性収縮）と膝蓋靭帯が緊張し、幅を確認しやすくなります。",s:"58ページ"},
    {q:"内側側副靭帯（MCL）の触診で、関節裂隙のくぼみが消失する部位はどこか？",o:["膝内側の中央","膝蓋骨の直下","膝窩","内側広筋の上"],c:0,r:"関節裂隙を前方から後方へたどると、側方で靭帯により裂隙が触れなくなります。そのさらに後方で再び触れるようになります。",s:"59ページ"},
    {q:"腸脛靭帯の前縁を確認するために、膝伸展位で行う動作は？",o:["腰を同側に突き出す（内転させる）","膝を曲げる","足を上げる","スクワット"],c:0,r:"膝を伸ばして体重をかけ、腰を横に突き出すと腸脛靭帯が緊張し、前縁が浮き出ます。",s:"61ページ"},
    {q:"腸脛靭帯の後縁は、どの筋との境界で触れるか？",o:["大腿二頭筋","内側広筋","半膜様筋","縫工筋"],c:0,r:"大腿二頭筋（外側ハムストリングス）の前方で腸脛靭帯の後縁を触れます。",s:"61ページ"},
    {q:"外側側副靭帯（LCL）を触診する際の最適な肢位は？",o:["あぐらをかく（股関節屈曲・外旋）","正座","直立","仰向けで足を伸ばす"],c:0,r:"あぐらをかくように足を組むと、LCLが索状に緊張して腓骨頭から大腿骨外側上顆へ走るのが触れやすくなります。",s:"62ページ"},
    {q:"大腿二頭筋腱とLCLの位置関係は？",o:["LCLは腱の深部（前方）にある","LCLは腱の表層にある","LCLは腱の後方にある","全く離れている"],c:0,r:"LCLは大腿二頭筋腱に覆われるように存在し、腱の少し前方深部で触れます。",s:"62ページ"},

    // 下腿（骨）
    {q:"脛骨の断面形状は？",o:["三角形","円形","四角形","板状"],c:0,r:"前縁、内側縁、骨間縁を持つ三角形をしています。",s:"63ページ"},
    {q:"「弁慶の泣き所」として触れられる鋭い骨隆起は？",o:["脛骨前縁","脛骨内側縁","腓骨前縁","腓骨外側縁"],c:0,r:"脛骨の前面を縦に走る前縁です。",s:"64ページ"},
    {q:"脛骨内側縁の後方（内側）にある筋肉は？",o:["ヒラメ筋・腓腹筋","前脛骨筋","長趾伸筋","長腓骨筋"],c:0,r:"脛骨内側縁の後方には下腿三頭筋（ヒラメ筋・腓腹筋）が存在します。",s:"64ページ"},
    {q:"腓骨頭は下腿のどの位置にあるか？",o:["近位外側","近位内側","遠位外側","遠位内側"],c:0,r:"膝の外側、脛骨粗面より少し後方にある骨隆起です。",s:"51ページ"},

    // 下腿（筋・神経）
    {q:"前脛骨筋を触診する際の足関節の動きは？",o:["背屈かつ内反","底屈かつ外反","底屈かつ内反","背屈かつ外反"],c:0,r:"踵をつけて足先を内側に向けながら持ち上げる（背屈・内反）と、脛骨の外側で大きく収縮します。",s:"66ページ"},
    {q:"長趾伸筋を触診する際、足関節をどう固定して足趾を動かすか？",o:["中間位で足趾伸展","最大底屈","最大背屈","内反"],c:0,r:"足底を床につけたまま、足指だけを反らせると、前脛骨筋の外側で収縮します。",s:"66ページ"},
    {q:"長母趾伸筋腱が最も触れやすい部位は？",o:["足関節前面（前脛骨筋腱の外側）","足の裏","ふくらはぎ","外くるぶしの下"],c:0,r:"足首の前面で、前脛骨筋腱と長趾伸筋腱の間（やや深部）から母趾へ向かう腱を確認します。",s:"67ページ"},
    {q:"浅腓骨神経の圧痛点（放散痛が出る場所）は？",o:["腓骨頭の前方直下","膝窩","内果の後ろ","踵"],c:0,r:"腓骨頭の前方、長腓骨筋と前脛骨筋の境界付近を圧迫すると足の甲へ響きます。",s:"67ページ"},
    {q:"腓腹筋を触診する際、足関節をどう動かすと筋腹が膨隆するか？",o:["底屈（つま先立ち）","背屈","内反","外反"],c:0,r:"膝を伸ばして足首を底屈（つま先で床を押す）させると、ふくらはぎで大きく膨らみます。",s:"69ページ"},
    {q:"ヒラメ筋を腓腹筋と区別して触診する部位は？",o:["アキレス腱の内外側（遠位）","膝窩","膝蓋骨の上","大腿部"],c:0,r:"腓腹筋の筋腹より下、アキレス腱の両脇から奥に広がる部分で触診します。",s:"69ページ"},
    {q:"脛骨神経を触診する部位は？",o:["膝窩中央（腓腹筋の間）","膝蓋骨の上","腓骨頭","脛骨粗面"],c:0,r:"膝裏の真ん中、腓腹筋の谷間を深圧すると確認できます。",s:"70ページ"},
    {q:"膝窩筋を触診する際、下腿をどう動かすと緊張するか？",o:["内旋","外旋","外反","内反"],c:0,r:"踵をつけたままつま先を内側に向ける（下腿内旋）と、脛骨内側縁の裏側でわずかに緊張します。",s:"70ページ"},
    {q:"長腓骨筋を触診する際の足の動きは？",o:["外がえし（底屈＋外反）","内がえし","背屈","足趾屈曲"],c:0,r:"母指球を床につけたまま、小指側を浮かせる（外がえし）と腓骨頭の下で収縮します。",s:"72ページ"},
    {q:"短腓骨筋腱の停止部はどこか？",o:["第5中足骨粗面","第1中足骨","舟状骨","踵骨"],c:0,r:"外果の後ろを通って、第5中足骨の根本（粗面）に停止します。",s:"73ページ"},
    {q:"総腓骨神経の触診部位は？",o:["腓骨頭の後方","腓骨頭の前方","膝蓋骨の下","内果の後ろ"],c:0,r:"腓骨頭の後方（やや下）を指で弾くと、足の外側へ響く感覚があります。",s:"73ページ"},

    // 足関節・足部（骨）
    {q:"距腿関節（足関節）の底屈可動域は？",o:["約45〜60度","10度","90度","180度"],c:0,r:"底屈は約60度、背屈は約20度です。",s:"78ページ"},
    {q:"距骨滑車（前部）を触診するのに適した肢位は？",o:["底屈位","背屈位","内反位","外反位"],c:0,r:"底屈すると距骨滑車が前方に現れ、触れやすくなります。背屈すると関節窩に入り込みます。",s:"79ページ"},
    {q:"距骨内側結節（後突起）の触診位置は？",o:["内果の1横指後方","内果の直上","外果の下","舟状骨の上"],c:0,r:"内果の遠位端から1横指ほど後方で、深部に小さな骨隆起として触れます。",s:"79ページ"},
    {q:"外果と内果、どちらが低い（遠位にある）か？",o:["外果","内果","同じ","個人差がある"],c:0,r:"外果の方が内果より長く、低い位置（遠位）にあります。",s:"81ページ"},
    {q:"踵骨隆起の触れにくい面は？",o:["内側面・足底面","後面","外側面","上面"],c:0,r:"内側や足底は軟部組織が厚く、骨の輪郭が触れにくいです。",s:"84ページ"},
    {q:"腓骨筋滑車は踵骨のどの面にあるか？",o:["外側面","内側面","後面","底面"],c:0,r:"外果の約1横指下、踵骨の外側面に位置する小さな突起です。",s:"85ページ"},
    {q:"載距突起は踵骨のどの面にあるか？",o:["内側面","外側面","後面","底面"],c:0,r:"内果の約1横指下、踵骨の内側面に位置する棚状の突起です。",s:"86ページ"},
    {q:"足根洞の入り口はどこにあるか？",o:["外果の前下方","内果の前下方","踵の後ろ","足の裏"],c:0,r:"外果の前下方にあり、足を内反させると大きく開くくぼみです。",s:"86ページ"},
    {q:"舟状骨粗面の位置は？",o:["内果の前下方","外果の前下方","踵骨の後ろ","足背の中央"],c:0,r:"内果から前下方にたどったところにある、内側アーチの頂点となる骨隆起です。",s:"89ページ"},
    {q:"舟状骨粗面に付着する主要な筋は？",o:["後脛骨筋","前脛骨筋","長腓骨筋","短腓骨筋"],c:0,r:"後脛骨筋腱が主として付着します。",s:"89ページ"},
    {q:"踵立方関節（CC関節）を探す際の手がかりは？",o:["第5中足骨粗面の近位","内果","舟状骨","距骨"],c:0,r:"第5中足骨粗面から外側縁を近位へたどり、凹み（立方骨）を越えたあたりです。",s:"90ページ"},
    {q:"第5中足骨粗面（茎状突起）は足のどこにあるか？",o:["外側縁の中央付近","内側縁","踵","足指の先"],c:0,r:"足の外側縁を後ろから前へなぞると最初に触れる大きな出っ張りです。",s:"93ページ"},
    {q:"リスフラン関節（足根中足関節）を確認するために動かす骨は？",o:["中足骨","距骨","踵骨","脛骨"],c:0,r:"中足骨を把持して上下に動かし、近位の足根骨（楔状骨・立方骨）との動きの境目を探します。",s:"95ページ"},
    {q:"母趾中足骨の近位（底部）と関節する骨は？",o:["内側楔状骨","舟状骨","中間楔状骨","立方骨"],c:0,r:"第1中足骨は内側楔状骨と関節します。",s:"96ページ"},

    // 足関節・足部（靭帯・筋・その他）
    {q:"外側側副靭帯（LCL）を構成する3つの靭帯は？",o:["前距腓・後距腓・踵腓靭帯","三角靭帯","スプリング靭帯","二分靭帯"],c:0,r:"外くるぶし（外果）の周りにある前距腓靭帯(ATFL)、後距腓靭帯(PTFL)、踵腓靭帯(CFL)の3つです。",s:"97ページ"},
    {q:"前距腓靭帯（ATFL）が最も緊張する肢位は？",o:["底屈・内反","背屈・外反","背屈・内反","底屈・外反"],c:0,r:"足首を伸ばして内側に捻る（底屈・内反）と、外果の前でピンと張ります。",s:"98ページ"},
    {q:"踵腓靭帯（CFL）が最も緊張する肢位は？",o:["背屈・内反（または中間位・内反）","底屈・内反","底屈・外反","背屈・外反"],c:0,r:"足首を90度付近に保ち、内側に捻る（回外・内反）と、外果の下で緊張します。",s:"98ページ"},
    {q:"後距腓靭帯（PTFL）の触診位置は？",o:["外果の後方","外果の前方","内果の後方","踵の上"],c:0,r:"外果の後ろ側、深い位置にあります。",s:"99ページ"},
    {q:"足背動脈の拍動を触れる場所は？",o:["長母趾伸筋腱と長趾伸筋腱の間","内果の後ろ","外果の後ろ","アキレス腱の上"],c:0,r:"足の甲の真ん中あたり、親指を反らす腱と他の指を反らす腱の間で触れます。",s:"104ページ"},
    {q:"二分靭帯（Y靭帯）の圧痛点はどこか？",o:["外果の前下方（踵骨前方）","内果の下","アキレス腱付着部","第5中足骨"],c:0,r:"外くるぶしの斜め前下、踵骨と立方骨・舟状骨の間にあるくぼみです。",s:"104ページ"},
    {q:"長母趾屈筋腱が通る「載距突起の下」の溝を何というか？",o:["長母趾屈筋腱溝","腓骨筋滑車","足根洞","足根管"],c:0,r:"載距突起の下を通り、足の親指へ向かいます。",s:"85ページ"},
    {q:"短腓骨筋腱が付着する場所は？",o:["第5中足骨粗面","第1中足骨","舟状骨","踵骨"],c:0,r:"外果の後ろを通り、足の外側の出っ張り（第5中足骨粗面）に停止します。",s:"73ページ"},
    {q:"長腓骨筋腱は足裏のどこを通って停止するか？",o:["足底を横断して第1中足骨底へ","踵に停止","小指側に停止","足の甲に停止"],c:0,r:"外果の後ろ、立方骨の下を通り、足裏を斜めに横切って親指の付け根（第1中足骨底・内側楔状骨）に停止します。",s:"73ページ"},
    {q:"アキレス腱の深部にある脂肪体（Kager's fat pad）が押し出される肢位は？",o:["背屈位","底屈位","内反位","外反位"],c:0,r:"足首を背屈させるとアキレス腱が骨に近づき、奥にある脂肪体が両脇に押し出されます。",s:"101ページ"},
    {q:"母趾外転筋の作用は？",o:["母趾の外転・屈曲","母趾の内転","母趾の伸展","小趾の外転"],c:0,r:"足の内側アーチを構成し、親指を開く・曲げる作用があります。外反母趾で弱化しやすいです。",s:"108ページ"},
    {q:"小趾外転筋の走行は？",o:["足の外側縁","足の内側縁","足の甲","アキレス腱"],c:0,r:"踵骨から第5中足骨に沿って足の外側縁を走ります。",s:"111ページ"},
    {q:"足底腱膜の起始部は？",o:["踵骨隆起","距骨","舟状骨","立方骨"],c:0,r:"踵の骨（踵骨隆起）の足底面から指先に向かって扇状に広がります。",s:"112ページ"}
];

// 3つのプールを結合
const questionPool = poolPart1.concat(poolPart2);

// シャッフル関数
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// クイズ状態管理
let currentQuizSet = [];
let currentQuestionIndex = 0;
let score = 0;

// 定数
const QUESTIONS_PER_ROUND = 30;

// DOM要素取得
const startScreen = document.getElementById('start-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionBox = document.getElementById('question');
const optionsBox = document.getElementById('options');
const feedbackBox = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const progress = document.getElementById('progress');
const scoreDisplay = document.getElementById('score');

// クイズ開始
function startQuiz() {
    // 全問題からランダムに30問抽出
    currentQuizSet = shuffle([...questionPool]).slice(0, QUESTIONS_PER_ROUND);
    currentQuestionIndex = 0;
    score = 0;
    
    startScreen.style.display = 'none';
    resultScreen.style.display = 'none';
    quizScreen.style.display = 'block';
    
    showQuestion();
}

// リセット（最初に戻る）
function resetQuiz(force = false) {
    if (force || confirm("最初の画面に戻りますか？")) {
        startScreen.style.display = 'block';
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'none';
    }
}

// 問題表示
function showQuestion() {
    const q = currentQuizSet[currentQuestionIndex];
    questionBox.textContent = `Q${currentQuestionIndex + 1}. ${q.q}`;
    optionsBox.innerHTML = '';
    feedbackBox.style.display = 'none';
    feedbackBox.className = 'feedback';
    nextBtn.classList.remove('active');
    
    progress.textContent = `問 ${currentQuestionIndex + 1} / ${QUESTIONS_PER_ROUND}`;
    scoreDisplay.textContent = `正解数: ${score}`;

    q.o.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index, btn, q);
        optionsBox.appendChild(btn);
    });
}

// 正誤判定
function checkAnswer(selectedIndex, selectedBtn, q) {
    if (nextBtn.classList.contains('active')) return; // 連打防止

    const isCorrect = (selectedIndex === q.c);
    const allBtns = document.querySelectorAll('.option-btn');

    if (isCorrect) {
        selectedBtn.classList.add('correct');
        feedbackBox.innerHTML = `<strong>正解！</strong><br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback';
        score++;
        scoreText.textContent = `正解数: ${score}`; // scoreTextをscoreDisplayに修正しないといけないが、ここで修正
        scoreDisplay.textContent = `正解数: ${score}`; // 正しい要素IDを使用
    } else {
        selectedBtn.classList.add('incorrect');
        // 正解のボタンを強調
        allBtns[q.c].classList.add('correct');
        feedbackBox.innerHTML = `<strong>不正解...</strong><br>正解は「${q.o[q.c]}」です。<br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback error';
    }

    feedbackBox.style.display = 'block';
    nextBtn.classList.add('active');
}

// 次の問題へ
function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < QUESTIONS_PER_ROUND) {
        showQuestion();
    } else {
        showResult();
    }
}

// 結果画面
function showResult() {
    quizScreen.style.display = 'none';
    resultScreen.style.display = 'block';
    
    const finalScoreEl = document.getElementById('final-score');
    const commentEl = document.getElementById('result-comment');
    
    finalScoreEl.textContent = score;
    
    const percentage = (score / QUESTIONS_PER_ROUND) * 100;
    let comment = "";
    let color = "";

    if (percentage === 100) {
        comment = "完璧です！触診マニュアルを完全にマスターしています。";
        color = "#27ae60"; // Green
    } else if (percentage >= 80) {
        comment = "素晴らしい！合格ライン達成です。現場で活かしましょう。";
        color = "#2980b9"; // Blue
    } else if (percentage >= 60) {
        comment = "惜しい！あと少しです。間違えた箇所を復習しましょう。";
        color = "#f39c12"; // Orange
    } else {
        comment = "知識の定着が必要です。マニュアルを読み返して再挑戦しましょう。";
        color = "#c0392b"; // Red
    }

    commentEl.textContent = comment;
    commentEl.style.color = color;
}
</script>
</body>
</html>
